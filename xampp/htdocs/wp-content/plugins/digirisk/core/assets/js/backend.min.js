function get_treated_element(a){var b={action:"wpdigi-dtrans-get-done-element",element:a};jQuery.post(ajaxurl,b,function(b){var c;for(c=0;c<b.transfert.length;c++)jQuery("#digi-datas-transfert-progression-container-"+b.transfert[c].type).html(b.transfert[c].text);b.auto_reload&&setTimeout(function(){get_treated_element(a)},"500")},"json")}jQuery(document).ready(function(a){digi_global.init(a),legal_display.init(a),digi_recommendation.init(!0,a),digi_risk.init(!0,a),digi_danger.init(!0,a),digi_search.event(a),digi_tools.event(a),digi_installer.event(a),digi_global.event(a),digi_evaluation_method.event(a),digi_evaluator.event(a),file_management.event(a),wpeo_gallery.event(a),digi_group.event(a),digi_society.event(a),digi_workunit.event(a),digi_tab.event(a),digi_user.event(a),digi_document.event(a)});var digi_global={$:void 0,init:function(a){digi_global.$=a,digi_global.$(".wpdigi_date").datepicker({dateFormat:"dd/mm/yy"})},event:function(){digi_global.$(document).on("click","toggle, .digi-toggle",function(a){a.stopPropagation();var d,b=digi_global.$(this),c=digi_global.$(this).data("parent");d=void 0!==c?digi_global.$(this).closest("."+c).find("."+digi_global.$(this).data("target")):digi_global.$(this).parent().find("."+digi_global.$(this).data("target")),digi_global.$(".digi-popup").each(function(){0===digi_global.$(this).has(a.target).length&&digi_global.$(this).is(":visible")&&!digi_global.$(this).hasClass(b.data("target"))&&digi_global.$(this).hide()}),d.toggle()}),digi_global.$(document).on("click",function(a){digi_global.$(".digi-popup").each(function(){0===digi_global.$(this).has(a.target).length&&digi_global.$(this).is(":visible")&&digi_global.$(this).toggle()})})},responsive_menu_toggle:function(a){digi_global.$(".wp-digi-sheet-tab-responsive-content").toggle("fast"),digi_global.$(".wp-digi-sheet-tab-title").toggleClass("active")},download_file:function(a,b){var c=digi_global.$('<a href="'+a+'" download="'+b+'"></a>');digi_global.$(".wrap").append(c),c[0].click(),c.remove()}},regex={validateEmail:function(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)}},digi_danger={old_danger:void 0,$:void 0,init:function(a,b){digi_danger.$=b,(a||void 0===a)&&digi_danger.event(),this.old_danger=digi_danger.$(".wp-digi-risk-item-new toggle").html()},event:function(a){digi_danger.$(document).on("click",".wp-digi-risk-item-new .wp-digi-select-list li",function(a){digi_danger.select_danger(a,digi_danger.$(this))})},select_danger:function(a,b){digi_danger.$('.wp-digi-risk-item-new input[name="danger_id"]').val(digi_danger.$(b).data("id")),digi_danger.$(".wp-digi-risk-item-new toggle span").html(digi_danger.$(b).find("img").attr("title"))},reset_create_form:function(){digi_danger.$(".wp-digi-risk-item-new toggle").html(digi_danger.old_danger),digi_danger.$('.wp-digi-risk-item-new input[name="danger_id"]').val("")}},digi_document={$:void 0,event:function(a){digi_document.$=a,digi_document.$(".wp-digi-societytree-right-container").on("click","#wpdigi-save-element-sheet",function(a){digi_document.save_element_sheet(a,digi_document.$(this))}),digi_document.$(".wp-digi-societytree-right-container").on("click",".wp-digi-list-document .wp-digi-action-delete",function(a){digi_document.delete_element_sheet(a,digi_document.$(this))}),digi_document.$(".wp-digi-societytree-right-container").on("click",".wp-digi-list-document .wp-digi-action-regenerate",function(a){digi_document.regenerate_document(a,digi_document.$(this))})},regenerate_document:function(a,b){a.preventDefault();var c={action:"wpdigi_regenerate_document",element_id:digi_document.$(b).data("id"),parent_id:digi_document.$(b).data("parent-id"),_wpnonce:digi_document.$(b).data("nonce")};digi_document.$.post(window.ajaxurl,c,function(){})},delete_element_sheet:function(a,b){a.preventDefault();var c={action:"wpdigi_delete_sheet",parent_id:digi_document.$(b).data("parent-id"),element_id:digi_document.$(b).data("id"),global:digi_document.$(b).data("global")};digi_document.$(b).closest("li").fadeOut(),digi_document.$.post(window.ajaxurl,c,function(){})},save_element_sheet:function(a,b){a.preventDefault();var c={beforeSubmit:function(a,c,d){digi_document.$(b).addClass("wp-digi-loading")},success:function(a,c,d,e){digi_document.$(b).removeClass("wp-digi-loading"),a.success&&(void 0!==digi_document.$(".wp-digi-global-sheet-content ul.wp-digi-list-document").html()?digi_document.$(".wp-digi-global-sheet-content ul.wp-digi-list-document").prepend(a.data.output):digi_document.$(".wp-digi-global-sheet-tab li.wp-digi-sheet-generation-button").click())},dataType:"json",resetForm:!0};digi_document.$("#wpdigi-save-element-form").ajaxSubmit(c)}},digi_evaluation_method={$:void 0,event:function(a){digi_evaluation_method.$=a,digi_evaluation_method.$(document).on("keyup",function(a){digi_evaluation_method.keyup(a,digi_evaluation_method.$(this))}),digi_evaluation_method.$(document).on("click","ul.wp-digi-risk-cotation-chooser li",function(a){digi_evaluation_method.select_cotation(a,digi_evaluation_method.$(this))}),digi_evaluation_method.$(document).on("click",".wpdigi-method-evaluation-render .row li",function(a){digi_evaluation_method.select_variable(a,digi_evaluation_method.$(this))}),digi_evaluation_method.$(document).on("click",".wpdigi-method-evaluation-render .wp-digi-bton-fourth",function(a){digi_evaluation_method.close_modal(digi_evaluation_method.$(this))}),digi_evaluation_method.$(document).on("click",".wpdigi-method-evaluation-render .dashicons-no-alt",function(a){digi_evaluation_method.close_modal(digi_evaluation_method.$(".wpdigi-method-evaluation-render .wp-digi-bton-fourth").click())})},keyup:function(a,b){27==a.keyCode&&digi_evaluation_method.$(".wpdigi-method-evaluation-render .dashicons-no-alt").click()},select_cotation:function(a,b){a.preventDefault();var c=digi_evaluation_method.$(b).closest("span"),d=digi_evaluation_method.$(b).attr("data-level"),e=digi_evaluation_method.$(b).closest(".wp-digi-list-item").find("input.digi-method-simple").val(),f=c.find("div"),g=f[0];g.className=g.className.replace(/wp-digi-risk-level-[0-4]/,"wp-digi-risk-level-"+d),f.html(digi_evaluation_method.$(b).text()),digi_evaluation_method.$(b).closest("form").find(".risk-level").val(d),digi_evaluation_method.$(b).closest(".wp-digi-list-item").find('input[name="method_evaluation_id"]').val(e)},select_variable:function(a,b){"undefined"!=digi_evaluation_method.$(b).data("seuil-id")&&(digi_evaluation_method.$('.wpdigi-method-evaluation-render .row li[data-variable-id="'+digi_evaluation_method.$(b).data("variable-id")+'"]').removeClass("active"),digi_evaluation_method.$(b).addClass("active"),digi_evaluation_method.$('.wpdigi-method-evaluation-render input[name="variable['+digi_evaluation_method.$(b).data("variable-id")+']"]').val(digi_evaluation_method.$(b).data("seuil-id")))},close_modal:function(a){var b={},c=0;digi_evaluation_method.$(".wpdigi-method-evaluation-render .wp-digi-eval-evarisk:visible").find('input[type="hidden"]:not(.digi-method-evaluation-id)').each(function(a,d){b[digi_evaluation_method.$(d).attr("variable-id")]=digi_evaluation_method.$(d).val(),""!==digi_evaluation_method.$(d).val()&&c++});var d={action:"get_scale",_wpnonce:digi_evaluation_method.$(a).data("nonce"),list_variable:b};return 5===c?(digi_evaluation_method.$(a).addClass("wp-digi-loading"),digi_evaluation_method.$.post(window.ajaxurl,d,function(b){digi_evaluation_method.$(".wpdigi-method-evaluation-render").hide(),digi_evaluation_method.$(a).closest(".wp-digi-list-item").find('input[name="method_evaluation_id"]').val(digi_evaluation_method.$(a).closest(".wpdigi-method-evaluation-render").find("input.digi-method-evaluation-id").val()),digi_evaluation_method.$(a).closest(".wp-digi-list-item").find(".wp-digi-risk-level-new").html(b.data.equivalence),digi_evaluation_method.$(a).closest(".wp-digi-list-item").find(".wp-digi-risk-list-column-cotation > div").attr("class","wp-digi-risk-level-new wp-digi-risk-level-"+b.data.scale),digi_evaluation_method.$(a).closest(".wp-digi-list-item").find('input[name="risk_evaluation_level"]').val(b.data.scale),digi_evaluation_method.$(a).removeClass("wp-digi-loading")})):digi_evaluation_method.$(".wpdigi-method-evaluation-render").hide(),!1}},digi_evaluator={$:void 0,event:function(a){digi_evaluator.$=a,digi_evaluator.$(document).on("click",'.wp-digi-evaluator-list input[type="checkbox"]',function(){digi_evaluator.add_time(digi_evaluator.$(this))}),digi_evaluator.$(document).on("click",'.wp-form-evaluator-to-assign input[type="submit"]',function(a){digi_evaluator.add_evaluator(a,digi_evaluator.$(this))}),digi_evaluator.$(document).on("click",".wp-digi-list-evaluator .wp-digi-action-delete",function(a){digi_evaluator.delete_evaluator(a,digi_evaluator.$(this))}),digi_evaluator.$(document).on("click",".wp-form-evaluator-to-assign .wp-digi-pagination a",function(a){digi_evaluator.pagination(a,digi_evaluator.$(this))})},add_time:function(a){digi_evaluator.$(a).closest("li").find(".period-assign input").val(digi_evaluator.$('.wp-digi-evaluator-list .wp-digi-table-header input[type="text"]').val())},add_evaluator:function(a,b){a.preventDefault(),digi_evaluator.$(".wp-digi-list-evaluator").addClass("wp-digi-bloc-loading"),digi_evaluator.$(b).closest("form").ajaxSubmit(function(a){digi_evaluator.$(".wp-digi-list-evaluator").replaceWith(a.data.template)})},delete_evaluator:function(a,b){if(a.preventDefault(),window.confirm(window.digi_confirm_delete)){digi_evaluator.$(".wp-digi-list-evaluator").addClass("wp-digi-bloc-loading");var c={action:"detach_evaluator",id:digi_evaluator.$(b).data("id"),user_id:digi_evaluator.$(b).data("user-id"),global:digi_evaluator.$(b).data("global"),affectation_id:digi_evaluator.$(b).data("affectation-data-id")};digi_evaluator.$.post(window.ajaxurl,c,function(a){digi_evaluator.$(".wp-digi-list-evaluator").replaceWith(a.data.template)})}},pagination:function(a,b){a.preventDefault();var c=digi_evaluator.$(b).attr("href").split("&"),d=c[1].replace("current_page=",""),e=c[2].replace("element_id=",""),f={action:"paginate_evaluator",element_id:e,next_page:d};digi_evaluator.$(".wp-form-evaluator-to-assign").load(window.ajaxurl,f,function(){})}},digi_export={$:void 0,init:function(a,b){digi_export.$=b,(a||void 0===a)&&digi_export.event()},event:function(){digi_export.$(document).on("submit","#digi-export-form",function(a){digi_export.create_export(a,digi_export.$(this))}),digi_export.$(document).on("change",'#digi-import-form input[type="file"]',function(a){digi_export.make_import(a,digi_export.$(this))})},create_export:function(a,b){a.preventDefault(),digi_export.$(b).closest("form").ajaxSubmit({beforeSubmit:function(){digi_export.$(b).closest(".wp-digi-bloc-loader").addClass("wp-digi-bloc-loading")},success:function(a){digi_export.$(b).closest(".wp-digi-bloc-loader").removeClass("wp-digi-bloc-loading"),window.digi_global.download_file(a.data.url_to_file,a.data.filename)}})},make_import:function(a,b){a.preventDefault();var c=new FormData;c.append("file",digi_export.$(b)[0].files[0]),c.append("action","digi_import_data"),c.append("_wpnonce",digi_export.$(b).closest("form").find('input[name="_wpnonce"]').val()),c.append("index_element",0),digi_export.request_import(c)},request_import:function(a){digi_export.$.ajax({url:ajaxurl,data:a,processData:!1,contentType:!1,type:"POST",beforeSend:function(){digi_export.$(".digi-import-detail").html(window.digi_tools_in_progress)},success:function(a){if(a.success){if(a.data.end)digi_export.$(".digi-import-detail").html(window.digi_tools_done);else{var b=new FormData;b.append("action","digi_import_data"),b.append("_wpnonce",digi_export.$("#digi-import-form").find('input[name="_wpnonce"]').val()),b.append("path_to_json",a.data.path_to_json),b.append("index_element",a.data.index_element),digi_export.$(".digi-import-detail").html(window.digi_tools_in_progress),digi_export.request_import(b)}digi_export.$("progress").attr("max",a.data.count_element),digi_export.$("progress").val(a.data.index_element/a.data.count_element*a.data.count_element)}else alert("Problème lors de l'importation du modèle"),digi_installer.$("#digi-data-export").removeClass("wp-digi-bloc-loading")}})}};jQuery(document).ready(function(a){digi_export.init(!0,a)});var file_management={file_frame:void 0,element_id:void 0,have_thumbnail:void 0,object_name:void 0,_wpnonce:void 0,$:void 0,event:function(a){file_management.$=a,file_management.$(document).on("click","span.wpeo-upload-media, a.wpeo-upload-media",function(a){file_management.open_popup(a,file_management.$(this))})},open_popup:function(a,b){a.preventDefault(),file_management.element_id=file_management.$(b).data("id"),file_management._wpnonce=file_management.$(b).data("nonce"),file_management.object_name=file_management.$(b).data("object-name"),file_management.have_thumbnail=!!file_management.$(b).hasClass("wp-digi-element-thumbnail"),window.wp.media.model.settings.post.id=file_management.$(b).data("id"),0===file_management.$(b).find(".wpeo-gallery").length?file_management.load_media_upload(b,file_management.$(b).data("id")):window.wpeo_gallery.open(b)},load_media_upload:function(a,b){file_management.file_frame=window.wp.media.frames.file_frame=window.wp.media({title:file_management.$(a).data("uploader_title"),button:{text:file_management.$(a).data("uploader_button_text")},multiple:!1}),file_management.file_frame.el.className+=" digi-upload-"+b,file_management.file_frame.on("select",function(){file_management.selected_file(a)}),file_management.open_media_upload()},open_media_upload:function(){file_management.file_frame.open()},selected_file:function(a){var c,d,b=file_management.file_frame.state().get("selection");b.map(function(a){c=a.toJSON(),d=a.id}),0===file_management.element_id?file_management.display_attachment(c,a):file_management.associate_file(d)},display_attachment:function(a,b){file_management.$(b).find("img").attr("src",a.url).show(),file_management.$(b).find("i").hide(),file_management.$(b).find('input[name="file_id"]').val(a.id)},associate_file:function(a){file_management.$('span.wpeo-upload-media[data-id="'+file_management.element_id+'"]').addClass("wp-digi-bloc-loading");var b={action:"eo_associate_file",file_id:a,_wpnonce:file_management._wpnonce,element_id:file_management.element_id,object_name:file_management.object_name,thumbnail:file_management.have_thumbnail};file_management.$.post(window.ajaxurl,b,function(a){file_management.$('span.wpeo-upload-media[data-id="'+file_management.element_id+'"]').replaceWith(a.data.template)})}},wpeo_gallery={$:void 0,event:function(a){wpeo_gallery.$=a,wpeo_gallery.$(document).on("keyup",function(a){wpeo_gallery.keyup(a,wpeo_gallery.$(this))}),wpeo_gallery.$(document).on("click",".wpeo-gallery",function(a){return a.preventDefault(),!1}),wpeo_gallery.$(document).on("click",".wpeo-gallery .prev",function(a){wpeo_gallery.prev(a,wpeo_gallery.$(this))}),wpeo_gallery.$(document).on("click",".wpeo-gallery .next",function(a){wpeo_gallery.next(a,wpeo_gallery.$(this))}),wpeo_gallery.$(document).on("click",".wpeo-gallery .set-as-thumbnail",function(a){wpeo_gallery.set_thumbnail(a,wpeo_gallery.$(this))}),wpeo_gallery.$(document).on("click",".wpeo-gallery .close",function(a){wpeo_gallery.close(a)})},keyup:function(a,b){37==a.keyCode?wpeo_gallery.$(".wpeo-gallery .prev").click():39==a.keyCode?wpeo_gallery.$(".wpeo-gallery .next").click():27==a.keyCode&&wpeo_gallery.$(".wpeo-gallery .close").click()},open:function(a){wpeo_gallery.$(a).find(".wpeo-gallery").show()},prev:function(a,b){a.preventDefault(),wpeo_gallery.$(b).closest("div").find(".image-list li.current").prev().length<=0?(wpeo_gallery.$(b).closest("div").find(".image-list li.current").toggleClass("current hidden"),wpeo_gallery.$(b).closest("div").find(".image-list li:last").toggleClass("hidden current")):wpeo_gallery.$(b).closest("div").find(".image-list li.current").toggleClass("current hidden").prev().toggleClass("hidden current")},next:function(a,b){a.preventDefault(),wpeo_gallery.$(b).closest("div").find(".image-list li.current").next().length<=0?(wpeo_gallery.$(b).closest("div").find(".image-list li.current").toggleClass("current hidden"),wpeo_gallery.$(b).closest("div").find(".image-list li:first").toggleClass("hidden current")):wpeo_gallery.$(b).closest("div").find(".image-list li.current").toggleClass("current hidden").next().toggleClass("hidden current")},set_thumbnail:function(a,b){var c={action:"eo_set_thumbnail",element_id:wpeo_gallery.$(b).closest("div").data("id"),thumbnail_id:wpeo_gallery.$(b).closest("div").find("li.current").data("id")};wpeo_gallery.$.post(window.ajaxurl,c,function(a){wpeo_gallery.$('span.wpeo-upload-media[data-id="'+window.file_management.element_id+'"]').find(".wp-post-image").replaceWith(a.data.template)})},close:function(a){wpeo_gallery.$(".wpeo-gallery").hide()}},digi_group={$:void 0,event:function(a){digi_group.$=a,digi_group.$(document).on("keyup",'input[name="wp-digi-group-name"]',function(a){digi_group.identity_edition_mode(a,digi_group.$(this))}),digi_group.$(document).on("click","#wp-digi-save-group-identity-button",function(a){digi_group.save_identity(a,digi_group.$(this))}),digi_group.$(document).on("click",".wp-digi-group-selector .wp-digi-new-group-action a",function(a){digi_group.create_group(a,digi_group.$(this))}),digi_group.$(document).on("click",".wp-digi-duer-form-display",function(a){digi_group.display_form_duer(a,digi_group.$(this))}),digi_group.$(".wp-digi-societytree-right-container").on("click",".wp-digi-duer-generation-button",function(a){digi_group.save_element_sheet(a,digi_group.$(this))}),digi_group.$(document).on("click",".wp-digi-form-save-configuration button",function(a){digi_group.save_configuration(a,digi_group.$(this))})},identity_edition_mode:function(a,b){digi_group.$(".wp-digi-group-action-container").removeClass("hidden"),digi_group.$(b).addClass("active"),digi_group.$(".wp-digi-societytree-left-container toggle span").html(digi_group.$(b).val()),digi_group.$(".wp-digi-group-action-container .wp-digi-bton-fourth").text("Enregistrer")},save_identity:function(a,b){digi_group.$(b).addClass("wp-digi-loading");var c=digi_group.$(b).closest(".wp-digi-group-sheet").data("id"),d={action:"wpdigi_ajax_group_update",_wpnonce:digi_group.$(b).data("nonce"),group_id:c,send_to_group_id:digi_group.$('input[name="wp-digi-group-id"]').val(),title:digi_group.$('input[name="wp-digi-group-name"]').val()};digi_group.$.post(window.ajaxurl,d,function(a){digi_group.$(b).removeClass("wp-digi-loading"),digi_group.$(b).removeClass("active"),digi_group.$(b).closest(".wp-digi-group-sheet-header").find(".wpdigi-auto-complete").val(""),digi_group.$(b).closest(".wp-digi-group-sheet-header").find('input[name="wp-digi-group-id"]').val("0"),void 0!==a.data.template_left&&digi_group.$(".wp-digi-societytree-left-container").html(a.data.template_left),digi_group.$(".wp-digi-group-action-container").addClass("hidden")})},create_group:function(a,b){a.preventDefault();var c=digi_group.$(b).data("id");digi_group.$(".wp-digi-group-selector .wp-digi-develop-list").toggle(),digi_group.$(".wp-digi-societytree-main-container").addClass("wp-digi-bloc-loading");var d={action:"wpdigi-create-group",group_id:c};digi_group.$.post(window.ajaxurl,d,function(a){digi_group.$(".wp-digi-societytree-main-container").removeClass("wp-digi-bloc-loading"),digi_group.$(".wp-digi-societytree-left-container").replaceWith(a.data.template_left),digi_group.$(".wp-digi-societytree-right-container").html(a.data.template_right),window.digi_global.init(digi_group.$),window.digi_workunit.event(digi_society.$),window.digi_search.event(digi_group.$)})},display_form_duer:function(a,b){a.preventDefault(),digi_group.$(".wp-digi-societytree-right-container").addClass("wp-digi-bloc-loading");var c={action:"load_sheet_display",element_id:digi_group.$(b).data("id"),tab_to_display:"digi-generate-sheet"};digi_group.$.post(window.ajaxurl,c,function(a){digi_group.$(".wp-digi-societytree-right-container").html(a.data.template),digi_group.$(".wp-digi-societytree-right-container").removeClass("wp-digi-bloc-loading")})},save_element_sheet:function(a,b){a.preventDefault();var c={beforeSubmit:function(a,c,d){digi_group.$(b).addClass("wp-digi-loading")},success:function(a,c,d,e){digi_group.$(b).removeClass("wp-digi-loading"),digi_group.$(".wp-digi-global-sheet-tab li[data-action='digi-sheet']").click()},dataType:"json"};digi_group.$("#wpdigi-save-element-form").ajaxSubmit(c)},save_configuration:function(a,b){a.preventDefault(),digi_group.$(b).closest("form").ajaxSubmit({beforeSubmit:function(){digi_group.$(".wp-digi-societytree-main-container").addClass("wp-digi-bloc-loading")},success:function(){digi_group.$(".wp-digi-societytree-main-container").removeClass("wp-digi-bloc-loading")}})}},digi_installer={$:void 0,event:function(a){digi_installer.$=a,window.digi_installer_user.event(a),digi_installer.$(document).on("click",'.wpdigi-installer form input[type="button"]',function(){digi_installer.form_groupement(digi_installer.$(this))}),digi_installer.$(document).on("click",".wpdigi-installer .btn-more-option",function(a){digi_installer.toggle_form(a,digi_installer.$(this))}),digi_installer.$(document).on("keyup",".wpdigi-staff .input-domain-mail",function(a){digi_installer.keyup_update_email(a,digi_installer.$(this))}),digi_installer.$(document).on("keyup",'#wp-digi-form-add-staff input[name="user[lastname]"]',function(a){digi_installer.keyup_update_email(a,digi_installer.$(this))}),digi_installer.$(document).on("keyup",'#wp-digi-form-add-staff input[name="user[firstname]"]',function(a){digi_installer.keyup_update_email(a,digi_installer.$(this))}),digi_installer.$(document).on("click",".wp-digi-action-save-domain-mail",function(a){digi_installer.save_domain_mail(a,digi_installer.$(this))})},form_groupement:function(a){digi_installer.$(a).closest("form").ajaxSubmit({beforeSubmit:function(){return""===digi_installer.$('.wpdigi-installer input[name="groupement[title]"]').val()?(digi_installer.$('.wpdigi-installer input[name="groupement[title]"]').css("border-bottom","solid red 2px"),!1):(digi_installer.$(a).closest("div").addClass("wp-digi-bloc-loading"),void digi_installer.$('.wpdigi-installer input[name="groupement[title]"]').css("border-bottom","2px solid #272a35"))},success:function(b){digi_installer.$(a).closest("div").hide(),digi_installer.$(".wpdigi-installer .wpdigi-staff").fadeIn(),digi_installer.$(".wpdigi-installer ul.step li:first").removeClass("active"),digi_installer.$(".wpdigi-installer ul.step li:last").addClass("active"),digi_installer.$("#toplevel_page_digi-setup a").attr("href",digi_installer.$("#toplevel_page_digi-setup a").attr("href").replace("digi-setup","digirisk-simple-risk-evaluation"))}})},keyup_update_email:function(a,b){var d=(digi_installer.$(".wpdigi-staff input[name='user[email]']").val(),digi_installer.$('.wpdigi-staff input[name="user[firstname]"]').val()),e=digi_installer.$('.wpdigi-staff input[name="user[lastname]"]').val(),f=digi_installer.$(".wpdigi-staff .input-domain-mail").val();digi_installer.$(".wpdigi-staff input[name='user[email]']").val(d+"."+e+"@"+f),13==a.keyCode&&digi_installer.$(".wpdigi-staff .add-staff").click()},save_domain_mail:function(a,b){a.preventDefault(),digi_installer.$(b).closest("li").addClass("wp-digi-bloc-loading");var c={action:"save_domain_mail",_wpnonce:digi_installer.$(b).data("nonce"),domain_mail:digi_installer.$(b).closest(".form-element").find("input").val()};digi_installer.$.post(window.ajaxurl,c,function(){digi_installer.$(b).closest("li").removeClass("wp-digi-bloc-loading")})},save_last_step:function(a,b){digi_installer.$(".wpdigi-installer .dashicons-plus:last").click()},toggle_form:function(a,b){a.preventDefault(),digi_installer.$(b).find(".dashicons").toggleClass("dashicons-plus dashicons-minus"),digi_installer.$(b).closest("form").find(".form-more-option").toggle()}},digi_installer_user={$:void 0,event:function(a){digi_installer_user.$=a,digi_installer_user.$(document).on("click",".wpdigi-staff .add-staff",function(a){digi_installer_user.add_staff(a,digi_installer_user.$(this))}),digi_installer_user.$(document).on("click",".wpdigi-staff .wp-digi-action-load",function(a){digi_installer_user.load_staff(a,digi_installer_user.$(this))}),digi_installer_user.$(document).on("click",".wpdigi-staff .wp-digi-action-edit",function(a){digi_installer_user.edit_staff(a,digi_installer_user.$(this))}),digi_installer_user.$(document).on("click",".wpdigi-staff .wp-digi-action-delete",function(a){digi_installer_user.delete_staff(a,digi_installer_user.$(this))})},add_staff:function(a,b){a.preventDefault(),""!==digi_installer_user.$('.wpdigi-staff input[name="user[lastname]"]').val()&&(digi_installer_user.$(".wp-digi-list-staff").addClass("wp-digi-bloc-loading"),digi_installer_user.$("#wp-digi-form-add-staff").ajaxSubmit({beforeSubmit:function(){if(!window.regex.validateEmail(digi_installer_user.$('.wpdigi-staff input[name="user[email]"]').val()))return digi_installer_user.$(".wp-digi-list-staff").removeClass("wp-digi-bloc-loading"),!1},success:function(a){digi_installer_user.$(".wp-digi-list-staff").removeClass("wp-digi-bloc-loading"),digi_installer_user.$(".wp-digi-list-staff").append(a.data.template),digi_installer_user.$('.wpdigi-staff input[name="user[firstname]"]').val(""),digi_installer_user.$('.wpdigi-staff input[name="user[lastname]"]').val(""),digi_installer_user.$(".wpdigi-staff input[name='user[email]']").val(digi_installer_user.$('.wpdigi-staff input[name="user[firstname]"]').val()+"."+digi_installer_user.$('.wpdigi-staff input[name="user[lastname]"]').val()+"@"+digi_installer_user.$(".wpdigi-staff .input-domain-mail").val()),digi_installer_user.$('.wpdigi-staff input[name="user[lastname]"]').focus()}}))},load_staff:function(a,b){a.preventDefault();var c=digi_installer_user.$(b).data("id");digi_installer_user.$('.wp-digi-list-item[data-id="'+c+'"]').addClass("wp-digi-bloc-loading");var d={action:"load_user",_wpnonce:digi_installer_user.$(b).data("nonce"),user_id:c};digi_installer_user.$.post(window.ajaxurl,d,function(a){digi_installer_user.$('.wp-digi-list-item[data-id="'+c+'"]').replaceWith(a.data.template)})},edit_staff:function(a,b){var c=digi_installer_user.$(b).closest("form").data("id");""!==digi_installer_user.$(b).closest("form").find('input[name="option[user_info][lastname]"]').val()&&(digi_installer_user.$(b).closest("form").addClass("wp-digi-bloc-loading"),digi_installer_user.$(b).closest("form").ajaxSubmit({beforeSubmit:function(){if(!window.regex.validateEmail(digi_installer_user.$(b).closest("form").find('input[name="user[email]"]').val()))return digi_installer_user.$(b).closest("form").removeClass("wp-digi-bloc-loading"),!1},success:function(a){digi_installer_user.$('.wp-digi-list-item[data-id="'+c+'"]').replaceWith(a.data.template)}}))},delete_staff:function(a,b){if(a.preventDefault(),window.confirm(window.digi_confirm_delete)){var c=digi_installer_user.$(b).data("id");digi_installer_user.$('.wp-digi-list-staff .wp-digi-list-item[data-id="'+c+'"]').fadeOut();var d={action:"delete_user",_wpnonce:digi_installer_user.$(b).data("nonce"),user_id:c};digi_installer_user.$.post(window.ajaxurl,d,function(){})}}},legal_display={$:void 0,init:function(a){legal_display.$=a,legal_display.init_form()},init_form:function(){var a={beforeSubmit:function(a,b,c){legal_display.$(".form-legal-display .generate-legal-display").addClass("wp-digi-loading")},success:function(a,b,c,d){legal_display.$(".form-legal-display .generate-legal-display").removeClass("wp-digi-loading"),legal_display.$('.wp-digi-global-sheet-tab li[data-action="digi-sheet"]').click()}};legal_display.$(document).on("click",".form-legal-display button",function(){return legal_display.$(this).closest("form").ajaxSubmit(a),!1})}},digi_recommendation={old_recommendation_name:void 0,old_thumbnail:void 0,$:void 0,init:function(a,b){digi_recommendation.$=b,digi_recommendation.old_recommendation_name=digi_recommendation.$(".wp-digi-recommendation-item-new toggle").html(),digi_recommendation.old_thumbnail=digi_recommendation.$(".wp-digi-recommendation-item-new .wp-digi-recommendation-thumbnail").html(),(a||void 0===a)&&digi_recommendation.event()},event:function(){digi_recommendation.$(document).on("click",".wp-digi-recommendation-item-new .wp-digi-select-list li",function(a){digi_recommendation.select_recommendation(a,digi_recommendation.$(this))}),digi_recommendation.$(document).on("click",".wp-digi-recommendation-item-new .dashicons-plus",function(a){digi_recommendation.add_recommendation(a,digi_recommendation.$(this))}),digi_recommendation.$(document).on("click",".wp-digi-recommendation-item .wp-digi-action-load",function(a){digi_recommendation.load_recommendation(a,digi_recommendation.$(this))}),digi_recommendation.$(document).on("click",".wp-digi-recommendation-item .wp-digi-action-edit",function(a){digi_recommendation.edit_recommendation(a,digi_recommendation.$(this))}),digi_recommendation.$(document).on("click",".wp-digi-recommendation-item .wp-digi-action-delete",function(a){digi_recommendation.delete_recommendation(a,digi_recommendation.$(this))})},select_recommendation:function(a,b){digi_recommendation.$(".wp-digi-recommendation-item-new input[name=recommendation_id]").val(digi_recommendation.$(b).data("id")),digi_recommendation.$(".wp-digi-recommendation-item-new .wp-digi-select-list").toggle(),digi_recommendation.$(".wp-digi-recommendation-item-new .wp-digi-recommendation-thumbnail i").hide(),digi_recommendation.$(".wp-digi-recommendation-item-new toggle").html(digi_recommendation.$(b).data("name")),digi_recommendation.$(".wp-digi-recommendation-item-new .wp-digi-recommendation-thumbnail .attachment-digirisk-element-miniature").attr("src",digi_recommendation.$(b).data("url")).show()},add_recommendation:function(a,b){a.preventDefault(),digi_recommendation.$(".wp-digi-recommendation-item-new").addClass("wp-digi-bloc-loading"),digi_recommendation.$(b).closest("form").ajaxSubmit({success:function(a){digi_recommendation.$(".wp-digi-recommendation-item-new").removeClass("wp-digi-bloc-loading"),digi_recommendation.$(".wp-digi-recommendation.wp-digi-list").append(a.data.template),digi_recommendation.$(".wp-digi-recommendation-item-new toggle").html(digi_recommendation.old_recommendation_name),digi_recommendation.$('.wp-digi-recommendation-item-new input[name="recommendation_id"]').val(""),digi_recommendation.$('.wp-digi-recommendation-item-new input[name="recommendation_comment"]').val(""),digi_recommendation.$(".wp-digi-recommendation-item-new .wp-digi-recommendation-thumbnail").html(digi_recommendation.old_thumbnail)}})},load_recommendation:function(a,b){a.preventDefault();var c={action:"wpdigi-load-recommendation",_wpnonce:digi_recommendation.$(b).data("nonce"),workunit_id:digi_recommendation.$(b).data("workunit-id"),term_id:digi_recommendation.$(b).data("id"),index:digi_recommendation.$(b).data("index")};digi_recommendation.$.post(window.ajaxurl,c,function(a){digi_recommendation.$(b).closest(".wp-digi-recommendation-item").replaceWith(a.data.template)})},edit_recommendation:function(a,b){digi_recommendation.$(b).closest(".wp-digi-recommendation-item").addClass("wp-digi-bloc-loading"),digi_recommendation.$(b).closest("form").ajaxSubmit({success:function(a){digi_recommendation.$(b).closest(".wp-digi-recommendation-item").replaceWith(a.data.template)}})},delete_recommendation:function(a,b){if(a.preventDefault(),window.confirm(window.digi_confirm_delete)){var c=digi_recommendation.$(b).data("workunit-id"),d=digi_recommendation.$(b).data("id"),e=digi_recommendation.$(b).data("index"),f=digi_recommendation.$(b).data("nonce"),g={action:"wpdigi-delete-recommendation",_wpnonce:f,workunit_id:c,term_id:d,index:e};digi_recommendation.$(b).closest(".wp-digi-recommendation-item").fadeOut(),digi_recommendation.$.post(window.ajaxurl,g,function(){})}}},digi_risk={old_date:void 0,button:void 0,
old_cotation:void 0,$:void 0,init:function(a,b){digi_risk.$=b,(a||void 0===a)&&(window.digi_risk_comment.event(digi_risk.$),window.digi_danger.init(a,digi_risk.$),digi_risk.event()),this.old_date=digi_risk.$('.wp-digi-risk-item-new input[name="risk_comment_date"]').val(),this.old_cotation=digi_risk.$(".wp-digi-risk-item-new .wp-digi-risk-level-new").html()},event:function(){digi_risk.$(document).on("click",".wp-digi-risk-item-new .wp-digi-action-new",function(a){digi_risk.create_risk(a,digi_risk.$(this))}),digi_risk.$(document).on("click",".wp-digi-risk .wp-digi-action-delete",function(a){digi_risk.delete_risk(a,digi_risk.$(this))}),digi_risk.$(document).on("click",".wp-digi-risk .wp-digi-action-load",function(a){digi_risk.load_risk(a,digi_risk.$(this))}),digi_risk.$(document).on("click",".wp-digi-risk .wp-digi-action-edit",function(a){digi_risk.edit_risk(a,digi_risk.$(this))})},create_risk:function(a,b){return digi_risk.$(b).closest("form").ajaxSubmit({beforeSubmit:function(){var a=!1;return"0"===digi_risk.$(b).closest("form").find('input[name="method_evaluation_id"]').val()&&(digi_risk.$(b).closest("form").find(".wp-digi-risk-list-column-cotation").css("border","solid red 2px"),a=!0),""===digi_risk.$(b).closest("form").find('input[name="danger_id"]').val()&&(digi_risk.$(b).closest("form").find(".wp-digi-summon-list").css("border","solid red 2px"),a=!0),digi_risk.$(b).closest("form").find('input[name="list_comment[0][comment_date]"]').val()||(digi_risk.$(b).closest("form").find('input[name="list_comment[0][comment_date]"]').css("border","solid red 2px"),a=!0),!a&&(digi_risk.$(b).closest("form").find(".wp-digi-risk-list-column-cotation").css("border","none"),digi_risk.$(b).closest("form").find(".wp-digi-summon-list").css("border","1px solid rgba(0,0,0,.2)"),digi_risk.$(b).closest("form").find('input[name="risk_comment_date"]').css("border","none"),void digi_risk.$(".wp-digi-content").addClass("wp-digi-bloc-loading"))},success:function(a){digi_risk.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_risk.$(".wp-digi-content > :first-child").replaceWith(a.data.template),digi_risk.reset_create_form()}}),!1},delete_risk:function(a,b){if(a.preventDefault(),window.confirm(window.digi_confirm_delete)){var c=digi_risk.$(b).data("id");digi_risk.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var d={action:"wpdigi-delete-risk",_wpnonce:digi_risk.$(b).data("nonce"),global:digi_risk.$(b).data("global"),risk_id:c};digi_risk.$.post(window.ajaxurl,d,function(){digi_risk.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_risk.$('.wp-digi-list .wp-digi-list-item[data-risk-id="'+c+'"]').fadeOut()})}},load_risk:function(a,b){a.preventDefault(),digi_risk.send_risk();var c=digi_risk.$(b).data("id");digi_risk.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var d={action:"wpdigi-load-risk",_wpnonce:digi_risk.$(b).data("nonce"),global:digi_risk.$(b).data("global"),risk_id:c};digi_risk.$.post(window.ajaxurl,d,function(a){digi_risk.$(".wp-digi-list-item .dashicons-edit").hide(),digi_risk.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_risk.$('.wp-digi-risk .wp-digi-list-item[data-risk-id="'+c+'"]').replaceWith(a.data.template),digi_risk.$('.wp-digi-risk .wp-digi-list-item[data-risk-id="'+c+'"] .wpdigi-method-evaluation-render').html(a.data.table_evaluation_method),digi_risk.$(".wpdigi_date").datepicker({dateFormat:"dd/mm/yy"})})},edit_risk:function(a,b){a.preventDefault();digi_risk.$(b).data("id");digi_risk.$(".wp-digi-content").addClass("wp-digi-bloc-loading"),digi_risk.$(b).closest("form").ajaxSubmit({success:function(a){digi_risk.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_risk.$(".wp-digi-list-item .dashicons-edit").show(),digi_risk.$(".wp-digi-content > :first-child").replaceWith(a.data.template)}})},send_risk:function(){digi_risk.$(".wp-digi-table-item-edit").each(function(){digi_risk.$(this).find(".dashicons-edit").click()})},reset_create_form:function(){digi_risk.$(".wp-digi-risk-item-new .wp-digi-risk-level-new").html(digi_risk.old_cotation);var a=digi_risk.$(".wp-digi-risk-item-new .wp-digi-risk-list-column-cotation div")[0];a.className=a.className.replace(/wp-digi-risk-level-[0-4]/,"wp-digi-risk-level-0"),digi_risk.$('.wp-digi-risk-item-new input[name="risk_evaluation_level"]').val(""),digi_risk.$('.wp-digi-risk-item-new input[name="method_evaluation_id"]').val("0"),window.digi_risk_comment.reset_create_form(),window.digi_danger.reset_create_form()}},digi_risk_comment={$:void 0,event:function(a){digi_risk_comment.$=a,digi_risk_comment.$(document).on("click",".wp-digi-action-comment-delete",function(a){digi_risk_comment.delete_comment(a,digi_risk_comment.$(this))})},delete_comment:function(a,b){if(window.confirm(window.digi_confirm_delete)){var c={action:"delete_comment",_wpnonce:digi_risk_comment.$(b).data("nonce"),risk_id:digi_risk_comment.$(b).data("risk-id"),id:digi_risk_comment.$(b).data("id")};digi_risk_comment.$(b).closest("li").remove(),digi_risk_comment.$.post(window.ajaxurl,c,function(){})}},reset_create_form:function(){digi_risk_comment.$(".wp-digi-risk-item-new .wp-digi-risk-comment textarea").val("")}},digi_search={$:void 0,event:function(a){digi_search.$=a,digi_search.$.each(digi_search.$(".wp-list-search input"),function(a,b){var c={source:"admin-ajax.php?action=digi_search&next_action="+digi_search.$(b).data("next-action")+"&class="+digi_search.$(b).data("class")+"&id="+digi_search.$(b).data("id")+"&type="+digi_search.$(b).data("type"),minLength:0};digi_search.$(b).data("target")&&(c.search=function(a,c){digi_search.$("."+digi_search.$(b).data("target")).addClass("wp-digi-bloc-loading")},c.response=function(a,c){digi_search.$("."+digi_search.$(b).data("target")).replaceWith(c.content[1].template)},c.open=function(a,c){digi_search.$(b).autocomplete("close")}),digi_search.$(b).data("field")&&(c.select=function(a,c){digi_search.$('input[name="'+digi_search.$(b).data("field")+'"]').val(c.item.id),digi_global.$(".wp-digi-group-action-container").removeClass("hidden"),digi_global.$(".wp-digi-group-action-container .wp-digi-bton-fourth").text("Déplacer")}),digi_search.$(b).autocomplete(c)})}};jQuery(document).ready(function(){jQuery(document).unbind("keydown").bind("keydown",function(a){var b=!1;if(8===a.keyCode){var c=a.srcElement||a.target;b=("INPUT"!==c.tagName.toUpperCase()||"TEXT"!==c.type.toUpperCase()&&"PASSWORD"!==c.type.toUpperCase()&&"FILE"!==c.type.toUpperCase()&&"SEARCH"!==c.type.toUpperCase()&&"EMAIL"!==c.type.toUpperCase()&&"NUMBER"!==c.type.toUpperCase()&&"DATE"!==c.type.toUpperCase())&&"TEXTAREA"!==c.tagName.toUpperCase()||(c.readOnly||c.disabled)}b&&a.preventDefault()})});var digi_society={$:void 0,event:function(a){digi_society.$=a,digi_society.$(document).on("keyup",'input[name="establishment_name"]',function(a){digi_society.identity_edition_mode(a,digi_society.$(this))}),digi_society.$(document).on("click",".wp-digi-societytree-left-container .wp-digi-global-name",function(a){digi_society.load_society(a,digi_society.$(this))}),digi_society.$(document).on("click",".wp-digi-global-sheet-header button.wp-digi-save-identity-button",function(a){digi_society.save_society(a,digi_society.$(this))}),digi_society.$(document).on("click",".wp-digi-global-sheet-header .wp-digi-delete-action",function(a){digi_society.delete_society(a,digi_society.$(this))})},identity_edition_mode:function(a,b){digi_society.$(b).closest(".wp-digi-global-sheet-header").find(".wp-digi-global-action-container").removeClass("hidden"),digi_society.$(b).addClass("active"),digi_global.$(".wp-digi-group-action-container .wp-digi-bton-fourth").text("Enregistrer")},load_society:function(a,b){digi_society.$(".wp-digi-group-selector .digi-popup").hide(),digi_society.$(b).closest("ul").find("li.active").removeClass("active"),digi_society.$(b).closest("li").addClass("active"),digi_society.$(".wp-digi-societytree-right-container").addClass("wp-digi-bloc-loading"),digi_society.$(".wp-digi-societytree-left-container").addClass("wp-digi-bloc-loading");var c={action:"load_sheet_display",element_id:digi_society.$(b).closest("li").data("id"),tab_to_display:"digi-risk"};digi_society.$.post(window.ajaxurl,c,function(a){digi_society.$(".wp-digi-societytree-right-container").removeClass("wp-digi-bloc-loading"),digi_society.$(".wp-digi-societytree-right-container").html(a.data.template),digi_society.$(".wp-digi-societytree-left-container").removeClass("wp-digi-bloc-loading"),a.data.template_left&&digi_society.$(".wp-digi-societytree-left-container").replaceWith(a.data.template_left),window.digi_global.init(digi_society.$),window.digi_risk.init(!1,digi_society.$),window.digi_search.event(digi_society.$)})},save_society:function(a,b){digi_society.$(b).addClass("wp-digi-loading");var c=digi_society.$(b).closest(".wp-digi-sheet").data("id"),d={action:"save_society",id:c,parent_id:digi_society.$('input[name="group_id"]').val(),title:digi_society.$('input[name="establishment_name"]').val()};digi_society.$.post(window.ajaxurl,d,function(a){digi_society.$(".wp-digi-societytree-left-container").html(a.data.template_left),digi_society.$(b).removeClass("wp-digi-loading"),digi_society.$(".wp-digi-global-sheet-header .wp-digi-global-action-container").addClass("hidden"),digi_society.$(".wp-digi-global-sheet-header .wp-list-search input").val("")},"json")},delete_society:function(a,b){if(a.preventDefault(),window.confirm(window.digi_confirm_delete)){var c={action:"delete_society",element_id:digi_society.$(b).data("id")};digi_society.$(".wp-digi-societytree-main-container").addClass("wp-digi-bloc-loading"),digi_society.$.post(window.ajaxurl,c,function(a){digi_society.$(".wp-digi-societytree-main-container").removeClass("wp-digi-bloc-loading"),digi_society.$(".wp-digi-societytree-main-container").replaceWith(a.data.template)})}}},digi_tab={$:void 0,event:function(a){digi_tab.$=a,digi_tab.$(".wp-digi-societytree-right-container").on("click",".wp-digi-global-sheet-tab li",function(a){digi_tab.click_tab(a,digi_tab.$(this))})},click_tab:function(a,b){if(a.preventDefault(),!digi_tab.$(b).hasClass("disabled")){var c=digi_tab.$(b).data("action");digi_tab.$(".wp-digi-global-sheet-tab li.active").removeClass("active"),digi_tab.$(b).addClass("active"),digi_tab.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var d={action:"load_tab_content",_wpnonce:digi_tab.$(b).data("nonce"),tab_to_display:c,element_id:digi_tab.$(b).closest(".wp-digi-sheet").data("id")};digi_tab.$.post(window.ajaxurl,d,function(a){digi_tab.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_tab.$(".wp-digi-content").html(a.data.template),window.digi_global.init(digi_tab.$),window.digi_search.event(digi_tab.$);var b=c.replace("-","_");window[b]&&window[b].init&&window[b].init(!1,digi_tab.$)},"json")}}},digi_tools={$:void 0,event:function(a){digi_tools.$=a,digi_tools.$(document).on("click",".reset-method-evaluation",function(a){digi_tools.reset(a,digi_tools.$(this))}),digi_tools.$(document).on("click",".digi-tools-main-container .nav-tab",function(a){digi_tools.tab_switcher(a,digi_tools.$(this))}),digi_tools.$(document).on("click",".element-risk-compilation",function(a){digi_tools.risk_fixer(a,digi_tools.$(this))})},tab_switcher:function(a,b){a.preventDefault(),digi_tools.$(b).closest("h2").children(".nav-tab").each(function(){digi_tools.$(this).removeClass("nav-tab-active")}),digi_tools.$(b).addClass("nav-tab-active"),digi_tools.$(b).closest(".digi-tools-main-container").children("div").each(function(){digi_tools.$(this).hide()}),digi_tools.$("#"+digi_tools.$(b).attr("data-id")).show()},reset:function(a,b){if(a.preventDefault(),window.confirm(window.digi_tools_confirm)){digi_tools.$(b).addClass("wp-digi-loading"),digi_tools.$(b).closest("div").find("ul").html("");var c=document.createElement("li");c.innerHTML=window.digi_tools_in_progress,digi_tools.$(b).closest("div").find("ul").append(c);var d={action:"reset_method_evaluation",_wpnonce:digi_tools.$(b).data("nonce")};digi_tools.exec_request(c,d,b)}},risk_fixer:function(a,b){a.preventDefault(),digi_tools.$(b).addClass("wp-digi-loading"),digi_tools.$(b).closest("div").find("ul").html("");var c=document.createElement("li");c.innerHTML=window.digi_tools_in_progress,digi_tools.$(b).closest("div").find("ul").append(c);var d={action:"compil_risk_list",_wpnonce:digi_tools.$(b).data("nonce")};digi_tools.exec_request(c,d,b)},exec_request:function(a,b,c){digi_tools.$.post(window.ajaxurl,b,function(){digi_tools.$(c).removeClass("wp-digi-loading"),a.innerHTML+=" "+window.digi_tools_done})}};jQuery(document).ready(function(){jQuery("#wpdigi-datastransfer-form").ajaxForm({dataType:"json",beforeSubmit:function(a,b,c){b.children("button.wp-digi-bton").addClass("wp-digi-loading")},success:function(a,b,c,d){if(d.children("button.wp-digi-bton").removeClass("wp-digi-loading"),!a.status&&a.reload_transfert)"element"==a.sub_action?(jQuery(".wpdigi-transfered-element-nb-"+a.element_type).html(a.main_element_nb),a.main_element_nb==jQuery(".wpdigi-to-transfer-element-nb-"+a.element_type).html()&&jQuery(".wp-digi-datastransfer-element-type-name-"+a.element_type).addClass("dashicons-before dashicons-yes"),jQuery(".wpdigi-transfered-element-nb-"+a.sub_element_type).html(a.sub_element_nb),a.sub_element_nb==jQuery(".wpdigi-to-transfer-element-nb-"+a.sub_element_type).html()&&jQuery(".wp-digi-datastransfer-element-type-name-"+a.sub_element_type).addClass("dashicons-before dashicons-yes")):"config_components"==a.old_sub_action?jQuery(".wp-digi-transfert-components").html(a.display_components_transfer):(jQuery(".wpdigi-transfered-element-nb-documents").html(a.transfered),jQuery(".wpdigi-not-transfered-element-nb-documents").html(a.not_transfered),a.transfered+a.not_transfered==jQuery(".wpdigi-to-transfer-element-nb-wpdigi-to-transfer-element-nb-documents").html()&&jQuery("wp-digi-datastransfer-element-type-name-documents").addClass("dashicons-before dashicons-yes")),d.children("input[name=element_type_to_transfert]").val(a.element_type),d.children("input[name=sub_action]").val(a.sub_action),d.submit();else if(a.status){jQuery("#wp-digi-transfert-message").html(a.message).show(),jQuery("#wpdigi-datastransfer-form .wp-digi-bton-first").hide();var e={action:"reset_method_evaluation",_wpnonce:jQuery('input[name="_wpnonce"]').val()};jQuery.post(ajaxurl,e,function(){setTimeout(function(){window.location.href=a.redirect_to_url},"1500")})}}}),jQuery("input[name=wpdigi-dtrans-userid-behaviour]").click(function(){if(jQuery(this).is(":checked"))jQuery(".wp-digi-dtrans-userid-options-container").html("").hide();else{var a={action:"wpdigi-dtrans-transfert-options-load",element_type:jQuery(this).closest("form").children("input[name=element_type_to_transfert]").val()};jQuery(".wp-digi-dtrans-userid-options-container").load(ajaxurl,a).show()}})});var digi_user={old_affected_user:void 0,$:void 0,event:function(a){digi_user.$=a,digi_user.$(document).on("keyup",'.wp-list-search input[name="user_name_affected"]',function(){digi_user.search_affected_user(digi_user.$(this))}),digi_user.$(document).on("click",'.wp-form-user-to-assign input[type="submit"]',function(a){digi_user.add_user(a,digi_user.$(this))}),digi_user.$(document).on("click",".wp-digi-list-affected-user .wp-digi-action-delete",function(a){digi_user.delete_user(a,digi_user.$(this))}),digi_user.$(document).on("click",".wp-form-user-to-assign .wp-digi-pagination a",function(a){digi_user.pagination(a,digi_user.$(this))})},search_affected_user:function(a){if(digi_user.old_affected_user!=digi_user.$(a).val())if(digi_user.old_affected_user=digi_user.$(a).val(),digi_user.$(a).val().length>2){digi_user.$(a).val();digi_user.$(a).closest("form").ajaxSubmit(function(b){digi_user.$(a).closest("div").find(".wp-digi-list").replaceWith(b.data.template)})}else digi_user.$(a).val().length<=0&&digi_user.$(a).closest("form").ajaxSubmit(function(b){digi_user.$(a).closest("div").find(".wp-digi-list").replaceWith(b.data.template)})},add_user:function(a,b){a.preventDefault(),digi_user.$(".wp-digi-content").addClass("wp-digi-bloc-loading"),digi_user.$(b).closest("form").ajaxSubmit(function(a){digi_user.render(a)})},delete_user:function(a,b){if(a.preventDefault(),window.confirm(window.digi_confirm_delete)){digi_user.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var c={action:"detach_user",id:digi_user.$(b).data("id"),user_id:digi_user.$(b).data("user-id"),affectation_id:digi_user.$(b).data("affectation-data-id")};digi_user.$.post(window.ajaxurl,c,function(a){digi_user.render(a)})}},render:function(a){digi_user.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_user.$(".wp-digi-content").html(a.data.template)},pagination:function(a,b){a.preventDefault();var c=digi_user.$(b).attr("href").split("&"),d=c[1].replace("current_page=",""),e=c[2].replace("element_id=",""),f={action:"paginate_user",element_id:e,next_page:d};digi_user.$(".wp-form-user-to-assign").load(window.ajaxurl,f,function(){})}},digi_workunit={$:void 0,event:function(a){digi_workunit.$=a,digi_workunit.$(".wp-digi-societytree-main-container").on("keypress","input[name='workunit[title]']",function(a){digi_workunit.call_create_workunit(a)}),digi_workunit.$(".wp-digi-societytree-main-container").on("click",".wp-digi-new-workunit-action",function(a){digi_workunit.create_workunit(a,digi_workunit.$(this))}),digi_workunit.$(document).on("click",".wp-digi-list-workunit .wp-digi-action-delete",function(a){digi_workunit.delete_workunit(a,digi_workunit.$(this))}),digi_workunit.$(document).on("click",".wp-digi-sheet-tab-toggle",function(){window.digi_global.responsive_menu_toggle(digi_workunit.$(this))}),digi_workunit.$(document).on("click",".wp-digi-sheet-tab-responsive-content > li",function(){window.digi_global.responsive_menu_toggle(digi_workunit.$(this))})},call_create_workunit:function(a){13==a.keyCode&&(a.preventDefault(),digi_workunit.$(".wp-digi-societytree-main-container .wp-digi-new-workunit-action").click())},create_workunit:function(a,b){a.preventDefault(),digi_workunit.$("#wpdigi-workunit-creation-form").ajaxSubmit({dataType:"json",beforeSubmit:function(a,b,c){digi_workunit.$(".wp-digi-societytree-left-container").addClass("wp-digi-bloc-loading")},success:function(a,b,c,d){digi_workunit.$(".wp-digi-societytree-left-container").removeClass("wp-digi-bloc-loading"),digi_workunit.$(".wp-digi-list-workunit").replaceWith(a.data.template),digi_workunit.$(".wp-digi-workunit-"+a.data.id+" .wp-digi-global-name").click(),window.digi_search.event(digi_workunit.$)}})},delete_workunit:function(a,b){if(a.preventDefault(),window.confirm(window.digi_confirm_delete)){var c={action:"delete_society",element_id:digi_workunit.$(b).data("id")};digi_workunit.$(b).closest("li").fadeOut(),digi_workunit.$.post(window.ajaxurl,c,function(a){})}}};